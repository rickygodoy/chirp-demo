<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chirp Demo</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', path='style.css') }}"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <div class="header-container">
        <div class="logo">
          <img src="{{ url_for('static', path='logo.png') }}" alt="Logo">
        </div>
        <h1>Chirp Model Showcase</h1>
        <nav class="header-nav">
          <button class="tab-link active" data-tab="welcome">Welcome</button>
          <button class="tab-link" data-tab="singing-contest">
            Singing Contest
          </button>
          <button class="tab-link" data-tab="learning-contest">
            Learning Contest
          </button>
          <button class="tab-link" data-tab="sentiment-analysis">
            Call Analysis
          </button>
        </nav>
      </div>
    </header>

    <main class="main-content">
      <div id="welcome" class="tab-pane active">
        <div class="welcome-container">
          <h2>Welcome to the Chirp Model Showcase</h2>
          <p>
            This is an interactive demonstration of Google's Chirp model
          </p>
          <p>
            Navigate to the <strong>Singing Contest</strong> or <strong>Learning Contest</strong> tab to try it out.
          </p>
        </div>
      </div>

      <div id="singing-contest" class="tab-pane">
        <div class="main-container">
          <div class="content-card">
            <h2>The Chirp Singing Contest</h2>
            <p>
              You have to sing precisely on top of lyrics to earn points
              (accuracy, words confidence and timing).
            </p>
            <div class="interactive-area">
              <p class="prompt">
                Press 'Start Singing' and the microphone is yours! Good Luck!
              </p>
              <button id="caption-button" disabled>Start Singing</button>
              <div class="song-selection-container">
                <div id="song-select" class="custom-select">
                  <div class="select-trigger">
                    <span>Select a song first</span>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="arrow"
                    >
                      <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                  </div>
                  <div class="options">
                    <div class="option" data-value="aranha">A dona aranha</div>
                    <div class="option" data-value="atirei">
                      Atirei o pau no gato
                    </div>
                    <div class="option" data-value="cravo">
                      Cravo brigou com a rosa
                    </div>
                    <div class="option" data-value="peixe">Peixe vivo</div>
                    <div class="option" data-value="sapo">Sapo Cururu</div>
                    <div class="option" data-value="jingle">Jingle Bells</div>
                    <div class="option" data-value="spider">
                      Itsy-bitsy spider
                    </div>
                    <div class="option" data-value="wish">Merry Christmas</div>
                    <div class="option" data-value="old">
                      Old MacDonald had a farm
                    </div>
                  </div>
                </div>
              </div>
              <div id="timer-container" class="hidden">
                <div id="countdown-text"></div>
                <div id="progress-bar-container">
                  <div id="progress-bar"></div>
                </div>
              </div>
              <pre id="refrain-output"></pre>
              <pre id="caption-output"></pre>
              <div id="final-score-output"></div>
            </div>
          </div>

          <aside class="leaderboard-card">
            <h2>Highscores</h2>
            <table class="highscore-table">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>Name</th>
                  <th>Score</th>
                </tr>
              </thead>
              <tbody id="high-scores-body">
                <!-- Scores will be inserted here by script.js -->
              </tbody>
            </table>
          </aside>
        </div>
      </div>

      <div id="learning-contest" class="tab-pane">
        <div class="main-container">
          <div class="content-card">
            <h2>The Chirp Hearing Contest</h2>
            <p>You have to listen and write precisely to earn points</p>
            <div class="interactive-area">
              <p class="prompt">
                Press 'Play Sentence' and write what you hear! Good Luck!
              </p>
               <audio id="audio-player" style="display: none;"></audio>
              <button id="listen-btn">Play Sentence</button>

              <div class="answer-section">
                <input
                  type="text"
                  id="answer-input"
                  placeholder="Digite a frase que você ouviu..."
                />
                <button id="check-btn" disabled>Confirmar</button>
              </div>

              <div id="feedback">
                <!-- Feedback da rodada aparecerá aqui -->
              </div>

              <button id="play-again-btn" style="display: none;">Jogar Novamente</button>
            </div>
          </div>


          <aside class="leaderboard-card">
            <input id="score-learning" style="display: none;" />
            <h2>Highscores</h2>
            <table class="highscore-table">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>Name</th>
                  <th>Score</th>
                </tr>
              </thead>
              <tbody id="high-scores-body-learning">
                <!-- Scores will be inserted here by script.js -->
              </tbody>
            </table>
          </aside>
        </div>
      </div>

      <div id="sentiment-analysis" class="tab-pane">
        <div class="main-container">
          <div class="content-card">
              <h2>Call Analysis</h2>
              <p>
                In this demo you can see how Chirp can transcribe a Call
                with multiple speakers.
              </p>
              <div class="interactive-area">
                <p class="prompt">
                  Press 'Play Audio' to listen the audio
                </p>
                <audio id="sentiment-audio" src="{{ url_for('static', path='call_br.wav') }}" controls style="width: 100%;"></audio>
                <div class="sentiment-results"></div>
                <button id="analyze-sentiment-button">Analyze Call</button>
                <div id="analysis-container" style="display: none;">
                  <div id="loading-spinner"></div>
                  <p id="analysis-message" style="display: none;">
                    <table id="analysis-table" style="display: none;">
    <thead>
      <tr>
        <th>Speaker</th>
        <th>Text</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0</td>
        <td>Meu nome é Bruno, bom dia. Em que posso ajudar?</td>
      </tr>
      <tr>
        <td>1</td>
        <td>Bom dia. Eu tô ligando porque a minha fatura veio com 50 reais em serviços adicionais que eu não contratei e para piorar, viajei para Santos e Belo Horizonte na semana passada e fiquei totalmente sem sinal, um absurdo.</td>
      </tr>
      <tr>
        <td>0</td>
        <td>Entendo perfeitamente a sua frustração, senhora. Peço desculpas pelo transtorno. Só um momento, por favor, vou verificar seu cadastro.</td>
      </tr>
      <tr>
        <td>1</td>
        <td>Hum.</td>
      </tr>
      <tr>
        <td>0</td>
        <td>Certo, localizei aqui. Realmente houve um erro de tarifação e registramos uma instabilidade na cobertura dessas regiões.</td>
      </tr>
      <tr>
        <td>1</td>
        <td>E então?</td>
      </tr>
      <tr>
        <td>0</td>
        <td>Já estornei o valor cobrado indevidamente e pela falha no serviço, estou aplicando agora mesmo um desconto de 40% na sua próxima fatura como compensação. Pode ser?</td>
      </tr>
      <tr>
        <td>1</td>
        <td>Nossa, 40%? Perfeito, assim sim. Resolvido então, muito obrigado.</td>
      </tr>
      <tr>
        <td>0</td>
        <td>Eu que agradeço o contato. Tenha um ótimo dia.</td>
      </tr>
    </tbody>
  </table>
                  </p>
                </div>
              </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Modal for High Score Name Input -->
    <div id="highscore-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
        <h2>New High Score!</h2>
        <p id="modal-score-text"></p>
        <input type="text" id="player-name-input" placeholder="Enter your name" maxlength="20">
        <div class="modal-buttons">
          <button id="modal-save-button">Save</button>
          <button id="modal-cancel-button">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Modal for High Score Name Input -->
    <div id="highscore-modal-learning" class="modal-overlay" style="display: none;">
      <div class="modal-content">
        <h2>New High Score!</h2>
        <p id="modal-score-text-learning"></p>
        <input type="text" id="player-name-input-learning" placeholder="Enter your name" maxlength="20">
        <div class="modal-buttons">
          <button id="modal-save-button-learning">Save</button>
          <button id="modal-cancel-button-learning">Cancel</button>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', path='script.js') }}"></script>
  </body>
</html>
